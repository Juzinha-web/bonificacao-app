<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Descontos e Bonifica√ß√µes</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    h2 { color: #333; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h2>Resumo de Descontos e Bonifica√ß√µes</h2>
  <div id="resultado">Carregando...</div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const tecnicoParam = urlParams.get('tecnico');
    const tecnico = tecnicoParam ? tecnicoParam.trim().toLowerCase() : '';

    const tecnicosMap = {
      'daniel': 1, 'eduardo s': 2, 'fabior': 3, 'gui santos': 4,
      'jose': 5, 'juliano': 6, 'pedro': 7, 'tatiane': 8, 'vinicius': 9,
      'amilton': 13, 'edu n': 14, 'everton': 15, 'lisboa': 16,
      'kaique': 17, 'matheus': 18, 'maruyama': 19, 'vitor': 20, 'wallace': 21,
      'arnaldo': 1, 'caique': 2, 'emerson': 3, 'esteban': 4,
      'gimeno': 5, 'jo√£o v': 6, 'marcos': 7, 'douglas': 8
    };

    const coluna = tecnicosMap[tecnico];

    if (coluna === undefined) {
      document.getElementById('resultado').innerHTML = `<p>T√©cnico <strong>${tecnicoParam}</strong> n√£o encontrado.</p>`;
    } else {
      const sheetID = '1JkvxTOJbEe8CivitmiV8u8gIqU5YWAIL3QdP8BMqR0c';
      const apiKey = 'AIzaSyCoa7wr0MhbbM_gYZ2svKcsLY8Eq894NMw'; // üëà coloque sua chave aqui
      const range = 'apontamentos original may!A1:Z100';

      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetID}/values/${range}?key=${apiKey}`;

      fetch(url)
        .then(response => response.json())
        .then(data => {
          const rows = data.values;

          const linhaDesconto = (coluna <= 9 ? 39 : coluna <= 21 ? 81 : 81);
          const linhaBonificacao = linhaDesconto + 1;
          const linhaResultado = linhaDesconto + 2;

          const desconto = rows[linhaDesconto]?.[coluna] || 'R$0,00';
          const bonificacao = rows[linhaBonificacao]?.[coluna] || 'R$0,00';
          const resultado = rows[linhaResultado]?.[coluna] || 'R$0,00';

          document.getElementById('resultado').innerHTML = `
            <table>
              <tr><th>Desconto</th><th>Bonifica√ß√£o</th><th>Resultado</th></tr>
              <tr><td>${desconto}</td><td>${bonificacao}</td><td>${resultado}</td></tr>
            </table>
          `;
        })
        .catch(error => {
          console.error('Erro ao buscar os dados:', error);
          document.getElementById('resultado').innerHTML = `<p>Erro ao carregar os dados.</p>`;
        });
    }
  </script>
</body>
</html>
